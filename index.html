<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cash Tally Pro - Banker's Edition</title>
    <style>
        :root { 
            --p: #0f172a; --a: #3b82f6; --bg: #f8fafc; --s: #10b981; --card: #ffffff; --text: #1e293b; --border: #e2e8f0;
        }
        body.dark-mode {
            --p: #1e293b; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; --border: #334155;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: -apple-system, system-ui, sans-serif; 
            background: var(--bg); margin: 0; padding-bottom: 160px;
            color: var(--text); overflow-x: hidden; transition: background 0.3s;
        }

        header { 
            background: var(--p); color: white; padding: 15px 20px; 
            position: sticky; top: 0; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
        }

        .currency-selector { 
            padding: 8px; border-radius: 8px; background: white; 
            font-weight: bold; font-size: 0.85rem; color: #0f172a; border: none; width: 220px;
        }

        .icon-btn {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3);
            color: white; padding: 8px 12px; border-radius: 6px; cursor: pointer;
        }

        .menu-dropdown {
            position: absolute; top: 65px; right: 20px; background: var(--card);
            border: 1px solid var(--border); border-radius: 12px; display: none;
            flex-direction: column; width: 260px; box-shadow: 0 10px 15px rgba(0,0,0,0.2); z-index: 2005;
        }
        .menu-item {
            padding: 12px 15px; border-bottom: 1px solid var(--border); color: var(--text);
            font-size: 0.9rem; cursor: pointer; display: flex; align-items: center; justify-content: space-between;
        }
        .lang-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 5px; padding: 10px;
            background: var(--bg); border-top: 1px solid var(--border); display: none;
        }
        .lang-btn {
            padding: 8px; font-size: 0.75rem; border: 1px solid var(--border);
            border-radius: 6px; background: var(--card); color: var(--text); cursor: pointer; text-align: center;
        }

        .container { max-width: 600px; margin: 0 auto; padding: 10px; }

        .section-header-row {
            display: grid; grid-template-columns: 1.4fr 1fr 1fr;
            padding: 18px 10px 8px; font-size: 0.7rem; font-weight: 800;
            color: #64748b; text-transform: uppercase;
        }

        .cash-row { 
            background: var(--card); border-radius: 12px; padding: 12px 10px; 
            margin-bottom: 8px; display: grid; grid-template-columns: 1.4fr 1fr 1.1fr;
            align-items: center; border: 1px solid var(--border);
        }

        .denom-info { display: flex; align-items: center; gap: 8px; overflow: hidden; }
        .denom-visual { 
            flex-shrink: 0; width: 42px; height: 30px; background: #f1f5f9; border: 1px solid #cbd5e1; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 0.65rem; font-weight: 800; border-radius: 4px; color: #0f172a;
        }
        .visual-coin { border-radius: 50%; width: 36px; height: 36px; }
        .denom-text { font-size: 0.8rem; font-weight: 700; white-space: nowrap; }

        .input-box { 
            width: 95%; padding: 10px; border: 2px solid var(--border); 
            border-radius: 8px; font-size: 1.1rem; text-align: center; font-weight: 700;
            background: var(--bg); color: var(--text);
        }

        .subtotal-cell { text-align: right; font-family: 'Courier New', monospace; font-weight: 700; color: var(--a); font-size: 0.95rem; }

        .footer-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: var(--card); border-top: 2px solid var(--border);
            padding: 15px 25px; z-index: 2000;
        }
        .footer-top { display: flex; justify-content: space-between; align-items: center; }
        #grandTotal { font-size: 1.7rem; font-weight: 900; color: var(--s); transition: filter 0.2s; }
        #totalWords { 
            font-size: 0.7rem; font-weight: 600; color: var(--a); 
            margin-top: 5px; text-transform: capitalize; font-style: italic;
            max-width: 80%; line-height: 1.2;
        }
        .blurred { filter: blur(8px); }
        .secure-badge { font-size: 0.6rem; background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 10px; margin-left: 5px; }
    </style>
</head>
<body class="dark-mode">

<header>
    <select id="currencySelect" class="currency-selector" onchange="changeCurrency()"></select>
    <div style="display:flex; gap:8px">
        <button class="icon-btn" onclick="toggleFS()">‚õ∂</button>
        <button class="icon-btn" onclick="toggleMenu()">‚ãÆ</button>
    </div>
</header>

<div id="menu" class="menu-dropdown">
    <div class="menu-item" onclick="alert('AI Scanner is a PRO feature')"><span data-i18n="menu_ai">üì∏ AI Scanner</span> <span style="font-size:0.5rem; background:gold; color:black; padding:2px 4px; border-radius:4px">PRO</span></div>
    <div class="menu-item" onclick="toggleDarkMode()"><span data-i18n="menu_dark">üåô Dark Mode</span></div>
    <div class="menu-item" onclick="toggleLangGrid()"><span data-i18n="menu_lang">üåê Languages</span></div>
    <div id="langGrid" class="lang-grid">
        <button class="lang-btn" onclick="setLang('ar')">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
        <button class="lang-btn" onclick="setLang('zh')">‰∏≠Êñá</button>
        <button class="lang-btn" onclick="setLang('en')">English</button>
        <button class="lang-btn" onclick="setLang('es')">Espa√±ol</button>
        <button class="lang-btn" onclick="setLang('fr')">Fran√ßais</button>
        <button class="lang-btn" onclick="setLang('hi')">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
        <button class="lang-btn" onclick="setLang('ja')">Êó•Êú¨Ë™û</button>
        <button class="lang-btn" onclick="setLang('ko')">ÌïúÍµ≠Ïñ¥</button>
        <button class="lang-btn" onclick="setLang('la')">Latina</button>
        <button class="lang-btn" onclick="setLang('ru')">–†—É—Å—Å–∫–∏–π</button>
        <button class="lang-btn" onclick="setLang('sv')">Svenska</button>
    </div>
    <div class="menu-item" onclick="resetAll()"><span data-i18n="menu_reset">üîÑ Reset Current</span></div>
</div>

<div id="appContainer" class="container"></div>

<div class="footer-bar">
    <div class="footer-top">
        <div onclick="togglePrivacy()" style="cursor:pointer; flex:1">
            <div style="font-size: 0.6rem; font-weight: 900; color: #64748b;">
                <span data-i18n="total_label">GRAND TOTAL</span> <span class="secure-badge">SECURE</span>
            </div>
            <div id="grandTotal">0.00</div>
        </div>
        <button id="resetBtn" style="background:#fee2e2; border:none; color:#dc2626; padding:12px 20px; border-radius:10px; font-weight:bold;" onclick="resetAll()" data-i18n="clear_btn">Reset</button>
    </div>
    <div id="totalWords"></div>
</div>

<script>
    const i18n = {
        en: { menu_ai: "üì∏ AI Scanner", menu_dark: "üåô Dark Mode", menu_lang: "üåê Languages", menu_reset: "üîÑ Reset All", total_label: "GRAND TOTAL", clear_btn: "Reset", h_count: "Count", h_sub: "Sub Total", notes: "Notes", coins: "Coins" },
        fr: { menu_ai: "üì∏ Scanner IA", menu_dark: "üåô Mode Sombre", menu_lang: "üåê Langues", menu_reset: "üîÑ R√©initialiser", total_label: "TOTAL G√âN√âRAL", clear_btn: "Effacer", h_count: "Nombre", h_sub: "Sous-total", notes: "Billets", coins: "Pi√®ces" },
        sv: { menu_ai: "üì∏ AI Scanner", menu_dark: "üåô M√∂rkt L√§ge", menu_lang: "üåê Spr√•k", menu_reset: "üîÑ √Öterst√§ll", total_label: "TOTALT", clear_btn: "Rensa", h_count: "Antal", h_sub: "Delsumma", notes: "Sedlar", coins: "Mynt" },
        ko: { menu_ai: "üì∏ AI Ïä§Ï∫êÎÑà", menu_dark: "üåô Îã§ÌÅ¨ Î™®Îìú", menu_lang: "üåê Ïñ∏Ïñ¥ ÏÑ†ÌÉù", menu_reset: "üîÑ Î™®Îëê Ï¥àÍ∏∞Ìôî", total_label: "ÏµúÏ¢Ö Ìï©Í≥Ñ", clear_btn: "Ï¥àÍ∏∞Ìôî", h_count: "ÏàòÎüâ", h_sub: "ÏÜåÍ≥Ñ", notes: "ÏßÄÌèê", coins: "ÎèôÏ†Ñ" },
        es: { menu_ai: "üì∏ Esc√°ner AI", menu_dark: "üåô Modo Oscuro", menu_lang: "üåê Idiomas", menu_reset: "üîÑ Reiniciar", total_label: "GRAN TOTAL", clear_btn: "Limpiar", h_count: "Cantidad", h_sub: "Subtotal", notes: "Billetes", coins: "Monedas" },
        la: { menu_ai: "üì∏ AI Scrutator", menu_dark: "üåô Modus Obscurus", menu_lang: "üåê Linguae", menu_reset: "üîÑ Reset", total_label: "SUMMA TOTALIS", clear_btn: "Deles", h_count: "Numerus", h_sub: "Sub-summa", notes: "Chartulae", coins: "Nummi" },
        ja: { menu_ai: "üì∏ AI„Çπ„Ç≠„É£„Éä„Éº", menu_dark: "üåô „ÉÄ„Éº„ÇØ„É¢„Éº„Éâ", menu_lang: "üåê Ë®ÄË™ûÂàáÊõø", menu_reset: "üîÑ ÂÖ®„É™„Çª„ÉÉ„Éà", total_label: "Á∑èÂêàË®à", clear_btn: "„É™„Çª„ÉÉ„Éà", h_count: "ÊûöÊï∞", h_sub: "Â∞èË®à", notes: "Á¥ôÂπ£", coins: "Á°¨Ë≤®" },
        hi: { menu_ai: "üì∏ AI ‡§∏‡•ç‡§ï‡•à‡§®‡§∞", menu_dark: "üåô ‡§°‡§æ‡§∞‡•ç‡§ï ‡§Æ‡•ã‡§°", menu_lang: "üåê ‡§≠‡§æ‡§∑‡§æ‡§è‡§Ç", menu_reset: "üîÑ ‡§∏‡§¨ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç", total_label: "‡§ï‡•Å‡§≤ ‡§Ø‡•ã‡§ó", clear_btn: "‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç", h_count: "‡§ó‡§ø‡§®‡§§‡•Ä", h_sub: "‡§ï‡•Å‡§≤ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø", notes: "‡§®‡•ã‡§ü", coins: "‡§∏‡§ø‡§ï‡•ç‡§ï‡•á" },
        ar: { menu_ai: "üì∏ ŸÖÿßÿ≥ÿ≠ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä", menu_dark: "üåô ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ", menu_lang: "üåê ÿßŸÑŸÑÿ∫ÿßÿ™", menu_reset: "üîÑ ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑", total_label: "ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÉŸÑŸä", clear_btn: "ŸÖÿ≥ÿ≠", h_count: "ÿπÿØÿØ", h_sub: "ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä", notes: "ÿ£Ÿàÿ±ÿßŸÇ ŸÜŸÇÿØŸäÿ©", coins: "ÿπŸÖŸÑÿßÿ™ ŸÖÿπÿØŸÜŸäÿ©" },
        zh: { menu_ai: "üì∏ AIÊâ´Êèè‰ª™", menu_dark: "üåô Ê∑±Ëâ≤Ê®°Âºè", menu_lang: "üåê ËØ≠Ë®ÄÂàáÊç¢", menu_reset: "üîÑ ÈáçÁΩÆÂÖ®ÈÉ®", total_label: "Á¥ØËÆ°ÊÄªÈ¢ù", clear_btn: "Ê∏ÖÈô§", h_count: "Êï∞Èáè", h_sub: "Â∞èËÆ°", notes: "Á∫∏Â∏Å", coins: "Á°¨Â∏Å" },
        ru: { menu_ai: "üì∏ –ò–ò-—Å–∫–∞–Ω–µ—Ä", menu_dark: "üåô –¢–µ–º–Ω—ã–π —Ä–µ–∂–∏–º", menu_lang: "üåê –Ø–∑—ã–∫–∏", menu_reset: "üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ", total_label: "–ò–¢–û–ì–û", clear_btn: "–û—á–∏—Å—Ç–∏—Ç—å", h_count: "–ö–æ–ª-–≤–æ", h_sub: "–°—É–º–º–∞", notes: "–ö—É–ø—é—Ä—ã", coins: "–ú–æ–Ω–µ—Ç—ã" }
    };

    const currencies = {
        "AUD": { n: "Australia (Dollar)", s: "$", maj: "Dollars", min: "Cents", d: [{l: "100", v: 100, t: 'Notes', dn: "100 Dollars ($)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dollars ($)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Dollars ($)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dollars ($)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Dollars ($)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Dollars ($)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Dollar ($)"}, {l: "50c", v: 0.5, t: 'Coins', dn: "50 Cents (c)"}, {l: "20c", v: 0.2, t: 'Coins', dn: "20 Cents (c)"}, {l: "10c", v: 0.1, t: 'Coins', dn: "10 Cents (c)"}, {l: "5c", v: 0.05, t: 'Coins', dn: "5 Cents (c)"}]},
        "CAD": { n: "Canada (Dollar)", s: "$", maj: "Dollars", min: "Cents", d: [{l: "100", v: 100, t: 'Notes', dn: "100 Dollars ($)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dollars ($)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Dollars ($)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dollars ($)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Dollars ($)"}, {l: "$2", v: 2, t: 'Coins', dn: "2 Dollars (Toonie)"}, {l: "$1", v: 1, t: 'Coins', dn: "1 Dollar (Loonie)"}, {l: "50¬¢", v: 0.5, t: 'Coins', dn: "50 Cents (¬¢)"}, {l: "25¬¢", v: 0.25, t: 'Coins', dn: "25 Cents (¬¢)"}, {l: "10¬¢", v: 0.1, t: 'Coins', dn: "10 Cents (¬¢)"}, {l: "5¬¢", v: 0.05, t: 'Coins', dn: "5 Cents (¬¢)"}]},
        "CNY": { n: "China (Yuan)", s: "¬•", maj: "Yuan", min: "Jiao", d: [{l: "100", v: 100, t: 'Notes', dn: "100 Yuan (¬•)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Yuan (¬•)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Yuan (¬•)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Yuan (¬•)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Yuan (¬•)"}, {l: "1", v: 1, t: 'Notes', dn: "1 Yuan (¬•)"}, {l: "1ÂÖÉ", v: 1, t: 'Coins', dn: "1 Yuan (ÂÖÉ)"}, {l: "5Ëßí", v: 0.5, t: 'Coins', dn: "5 Jiao (Ëßí)"}, {l: "1Ëßí", v: 0.1, t: 'Coins', dn: "1 Jiao (Ëßí)"}]},
        "EUR": { n: "Eurozone (Euro)", s: "‚Ç¨", maj: "Euros", min: "Cents", d: [{l: "200", v: 200, t: 'Notes', dn: "200 Euros (‚Ç¨)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Euros (‚Ç¨)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Euros (‚Ç¨)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Euros (‚Ç¨)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Euros (‚Ç¨)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Euros (‚Ç¨)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Euros (‚Ç¨)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Euro (‚Ç¨)"}, {l: "50c", v: 0.5, t: 'Coins', dn: "50 Cents (c)"}, {l: "20c", v: 0.2, t: 'Coins', dn: "20 Cents (c)"}, {l: "10c", v: 0.1, t: 'Coins', dn: "10 Cents (c)"}, {l: "5c", v: 0.05, t: 'Coins', dn: "5 Cents (c)"}, {l: "2c", v: 0.02, t: 'Coins', dn: "2 Cents (c)"}, {l: "1c", v: 0.01, t: 'Coins', dn: "1 Cent (c)"}]},
        "HKD": { n: "Hong Kong (Dollar)", s: "HK$", maj: "Dollars", min: "Cents", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Dollars ($)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Dollars ($)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Dollars ($)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dollars ($)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Dollars ($)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dollars ($)"}, {l: "$10", v: 10, t: 'Coins', dn: "10 Dollars ($)"}, {l: "$5", v: 5, t: 'Coins', dn: "5 Dollars ($)"}, {l: "$2", v: 2, t: 'Coins', dn: "2 Dollars ($)"}, {l: "$1", v: 1, t: 'Coins', dn: "1 Dollar ($)"}, {l: "50¬¢", v: 0.5, t: 'Coins', dn: "50 Cents (¬¢)"}, {l: "20¬¢", v: 0.2, t: 'Coins', dn: "20 Cents (¬¢)"}, {l: "10¬¢", v: 0.1, t: 'Coins', dn: "10 Cents (¬¢)"}]},
        "INR": { n: "India (Rupee)", s: "‚Çπ", maj: "Rupees", min: "Paise", d: [{l: "500", v: 500, t: 'Notes', dn: "500 Rupees (‚Çπ)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Rupees (‚Çπ)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Rupees (‚Çπ)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Rupees (‚Çπ)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Rupees (‚Çπ)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Rupees (‚Çπ)"}, {l: "20", v: 20, t: 'Coins', dn: "20 Rupees (‚Çπ)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Rupees (‚Çπ)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Rupees (‚Çπ)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Rupees (‚Çπ)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Rupee (‚Çπ)"}]},
        "JPY": { n: "Japan (Yen)", s: "¬•", maj: "Yen", min: "", d: [{l: "10k", v: 10000, t: 'Notes', dn: "10,000 Yen (¬•)"}, {l: "5k", v: 5000, t: 'Notes', dn: "5,000 Yen (¬•)"}, {l: "2k", v: 2000, t: 'Notes', dn: "2,000 Yen (¬•)"}, {l: "1k", v: 1000, t: 'Notes', dn: "1,000 Yen (¬•)"}, {l: "500", v: 500, t: 'Coins', dn: "500 Yen (¬•)"}, {l: "100", v: 100, t: 'Coins', dn: "100 Yen (¬•)"}, {l: "50", v: 50, t: 'Coins', dn: "50 Yen (¬•)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Yen (¬•)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Yen (¬•)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Yen (¬•)"}]},
        "MYR": { n: "Malaysia (Ringgit)", s: "RM", maj: "Ringgit", min: "Sen", d: [{l: "100", v: 100, t: 'Notes', dn: "100 Ringgit (RM)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Ringgit (RM)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Ringgit (RM)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Ringgit (RM)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Ringgit (RM)"}, {l: "1", v: 1, t: 'Notes', dn: "1 Ringgit (RM)"}, {l: "50s", v: 0.5, t: 'Coins', dn: "50 Sen (s)"}, {l: "20s", v: 0.2, t: 'Coins', dn: "20 Sen (s)"}, {l: "10s", v: 0.1, t: 'Coins', dn: "10 Sen (s)"}, {l: "5s", v: 0.05, t: 'Coins', dn: "5 Sen (s)"}]},
        "MXN": { n: "Mexico (Peso)", s: "$", maj: "Pesos", min: "Centavos", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Pesos ($)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Pesos ($)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Pesos ($)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Pesos ($)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Pesos ($)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Pesos ($)"}, {l: "20", v: 20, t: 'Coins', dn: "20 Pesos ($)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Pesos ($)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Pesos ($)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Pesos ($)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Peso ($)"}, {l: "50¬¢", v: 0.5, t: 'Coins', dn: "50 Centavos (¬¢)"}]},
        "PHP": { n: "Philippines (Peso)", s: "‚Ç±", maj: "Pesos", min: "Centavos", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Pesos (‚Ç±)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Pesos (‚Ç±)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Pesos (‚Ç±)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Pesos (‚Ç±)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Pesos (‚Ç±)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Pesos (‚Ç±)"}, {l: "20", v: 20, t: 'Coins', dn: "20 Pesos (‚Ç±)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Pesos (‚Ç±)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Pesos (‚Ç±)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Peso (‚Ç±)"}, {l: "25¬¢", v: 0.25, t: 'Coins', dn: "25 Cents (¬¢)"}, {l: "5¬¢", v: 0.05, t: 'Coins', dn: "5 Cents (¬¢)"}]},
        "RUB": { n: "Russia (Ruble)", s: "‚ÇΩ", maj: "Rubles", min: "Kopecks", d: [{l: "5000", v: 5000, t: 'Notes', dn: "5000 Rubles (‚ÇΩ)"}, {l: "2000", v: 2000, t: 'Notes', dn: "2000 Rubles (‚ÇΩ)"}, {l: "1000", v: 1000, t: 'Notes', dn: "1000 Rubles (‚ÇΩ)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Rubles (‚ÇΩ)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Rubles (‚ÇΩ)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Rubles (‚ÇΩ)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Rubles (‚ÇΩ)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Rubles (‚ÇΩ)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Rubles (‚ÇΩ)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Rubles (‚ÇΩ)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Ruble (‚ÇΩ)"}]},
        "SGD": { n: "Singapore (Dollar)", s: "S$", maj: "Dollars", min: "Cents", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Dollars (S$)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Dollars (S$)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dollars (S$)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dollars (S$)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Dollars (S$)"}, {l: "2", v: 2, t: 'Notes', dn: "2 Dollars (S$)"}, {l: "$1", v: 1, t: 'Coins', dn: "1 Dollar (S$)"}, {l: "50¬¢", v: 0.5, t: 'Coins', dn: "50 Cents (¬¢)"}, {l: "20¬¢", v: 0.2, t: 'Coins', dn: "20 Cents (¬¢)"}, {l: "10¬¢", v: 0.1, t: 'Coins', dn: "10 Cents (¬¢)"}, {l: "5¬¢", v: 0.05, t: 'Coins', dn: "5 Cents (¬¢)"}]},
        "KRW": { n: "South Korea (Won)", s: "‚Ç©", maj: "Won", min: "", d: [{l: "50k", v: 50000, t: 'Notes', dn: "50,000 Won (‚Ç©)"}, {l: "10k", v: 10000, t: 'Notes', dn: "10,000 Won (‚Ç©)"}, {l: "5k", v: 5000, t: 'Notes', dn: "5,000 Won (‚Ç©)"}, {l: "1k", v: 1000, t: 'Notes', dn: "1,000 Won (‚Ç©)"}, {l: "500", v: 500, t: 'Coins', dn: "500 Won (‚Ç©)"}, {l: "100", v: 100, t: 'Coins', dn: "100 Won (‚Ç©)"}, {l: "50", v: 50, t: 'Coins', dn: "50 Won (‚Ç©)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Won (‚Ç©)"}]},
        "SEK": { n: "Sweden (Krona)", s: "kr", maj: "Kronor", min: "√ñre", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Kronor (kr)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Kronor (kr)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Kronor (kr)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Kronor (kr)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Kronor (kr)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Kronor (kr)"}, {l: "10", v: 10, t: 'Coins', dn: "10 Kronor (kr)"}, {l: "5", v: 5, t: 'Coins', dn: "5 Kronor (kr)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Kronor (kr)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Krona (kr)"}]},
        "AED": { n: "UAE (Dirham)", s: "DH ", maj: "Dirhams", min: "Fils", d: [{l: "1000", v: 1000, t: 'Notes', dn: "1000 Dirhams (DH)"}, {l: "500", v: 500, t: 'Notes', dn: "500 Dirhams (DH)"}, {l: "200", v: 200, t: 'Notes', dn: "200 Dirhams (DH)"}, {l: "100", v: 100, t: 'Notes', dn: "100 Dirhams (DH)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dirhams (DH)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Dirhams (DH)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dirhams (DH)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Dirhams (DH)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Dirham (DH)"}, {l: "50f", v: 0.5, t: 'Coins', dn: "50 Fils (f)"}, {l: "25f", v: 0.25, t: 'Coins', dn: "25 Fils (f)"}]},
        "GBP": { n: "UK (Pound)", s: "¬£", maj: "Pounds", min: "Pence", d: [{l: "50", v: 50, t: 'Notes', dn: "50 Pounds (¬£)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Pounds (¬£)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Pounds (¬£)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Pounds (¬£)"}, {l: "2", v: 2, t: 'Coins', dn: "2 Pounds (¬£)"}, {l: "1", v: 1, t: 'Coins', dn: "1 Pound (¬£)"}, {l: "50p", v: 0.5, t: 'Coins', dn: "50 Pence (p)"}, {l: "20p", v: 0.2, t: 'Coins', dn: "20 Pence (p)"}, {l: "10p", v: 0.1, t: 'Coins', dn: "10 Pence (p)"}, {l: "5p", v: 0.05, t: 'Coins', dn: "5 Pence (p)"}, {l: "2p", v: 0.02, t: 'Coins', dn: "2 Pence (p)"}, {l: "1p", v: 0.01, t: 'Coins', dn: "1 Penny (p)"}]},
        "USD": { n: "USA (Dollar)", s: "$", maj: "Dollars", min: "Cents", d: [{l: "100", v: 100, t: 'Notes', dn: "100 Dollars ($)"}, {l: "50", v: 50, t: 'Notes', dn: "50 Dollars ($)"}, {l: "20", v: 20, t: 'Notes', dn: "20 Dollars ($)"}, {l: "10", v: 10, t: 'Notes', dn: "10 Dollars ($)"}, {l: "5", v: 5, t: 'Notes', dn: "5 Dollars ($)"}, {l: "2", v: 2, t: 'Notes', dn: "2 Dollars ($)"}, {l: "1", v: 1, t: 'Notes', dn: "1 Dollar ($)"}, {l: "$1", v: 1, t: 'Coins', dn: "1 Dollar ($)"}, {l: "50¬¢", v: 0.5, t: 'Coins', dn: "50 Cents (¬¢)"}, {l: "25¬¢", v: 0.25, t: 'Coins', dn: "25 Cents (¬¢)"}, {l: "10¬¢", v: 0.1, t: 'Coins', dn: "10 Cents (¬¢)"}, {l: "5¬¢", v: 0.05, t: 'Coins', dn: "5 Cents (¬¢)"}, {l: "1¬¢", v: 0.01, t: 'Coins', dn: "1 Cent (¬¢)"}]}
    };

    let counts = {}, curKey = "AUD", currentLang = 'en';

    function boot() {
        const sel = document.getElementById('currencySelect');
        const sortedKeys = Object.keys(currencies).sort((a,b) => currencies[a].n.localeCompare(currencies[b].n));
        sortedKeys.forEach(k => {
            const o = document.createElement('option');
            o.value = k; o.textContent = currencies[k].n;
            sel.appendChild(o);
        });
        loadSecureData();
        setLang('en');
    }

    // Number to Words Converter (Bank Receipt Style)
    function numberToWords(num) {
        const ones = ["", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"];
        const tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"];
        const scales = ["", "thousand", "million", "billion"];

        function convertSection(n) {
            let res = "";
            if (n >= 100) { res += ones[Math.floor(n / 100)] + " hundred "; n %= 100; }
            if (n >= 20) { res += tens[Math.floor(n / 10)] + " "; n %= 10; }
            if (n > 0) res += ones[n] + " ";
            return res;
        }

        if (num === 0) return "Zero";
        let parts = [], i = 0;
        let integer = Math.floor(num);
        let decimal = Math.round((num - integer) * 100);

        while (integer > 0) {
            if (integer % 1000 !== 0) parts.unshift(convertSection(integer % 1000) + scales[i]);
            integer = Math.floor(integer / 1000); i++;
        }
        
        const currency = currencies[curKey];
        let result = parts.join(" ") + " " + currency.maj;
        if (decimal > 0 && currency.min) result += " and " + convertSection(decimal) + " " + currency.min;
        return result.trim().replace(/\s+/g, ' ');
    }

    function saveSecureData() {
        const encoded = btoa(JSON.stringify({key: curKey, counts: counts}));
        localStorage.setItem('tally_secure_vault_v2', encoded);
    }

    function loadSecureData() {
        const raw = localStorage.getItem('tally_secure_vault_v2');
        if (raw) {
            try {
                const dec = JSON.parse(atob(raw));
                if (dec.key) { curKey = dec.key; document.getElementById('currencySelect').value = curKey; }
                if (dec.counts) counts = dec.counts;
            } catch(e) {}
        }
    }

    function togglePrivacy() { document.getElementById('grandTotal').classList.toggle('blurred'); document.getElementById('totalWords').classList.toggle('blurred'); }
    function toggleMenu() { const m = document.getElementById('menu'); m.style.display = m.style.display === 'flex' ? 'none' : 'flex'; }
    function toggleLangGrid() { const g = document.getElementById('langGrid'); g.style.display = g.style.display === 'grid' ? 'none' : 'grid'; }

    function setLang(code) {
        currentLang = code;
        const dict = i18n[code] || i18n['en'];
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (dict[key]) el.textContent = dict[key];
        });
        render();
    }

    function toggleDarkMode() { document.body.classList.toggle('dark-mode'); toggleMenu(); }
    function changeCurrency() { curKey = document.getElementById('currencySelect').value; render(); }

    function render() {
        const cont = document.getElementById('appContainer');
        cont.innerHTML = '';
        const data = currencies[curKey];
        const dict = i18n[currentLang] || i18n['en'];
        let lastT = '';
        
        data.d.forEach((item, idx) => {
            if (item.t !== lastT) {
                const h = document.createElement('div');
                h.className = 'section-header-row';
                h.innerHTML = `<div>${item.t === 'Notes' ? dict.notes : dict.coins}</div><div style="text-align:center">${dict.h_count}</div><div style="text-align:right">${dict.h_sub}</div>`;
                cont.appendChild(h);
                lastT = item.t;
            }
            const row = document.createElement('div');
            row.className = 'cash-row';
            const val = counts[`${curKey}_${idx}`] || "";
            row.innerHTML = `
                <div class="denom-info">
                    <div class="denom-visual ${item.t === 'Coins' ? 'visual-coin' : ''}">${item.l}</div>
                    <div class="denom-text">${item.dn}</div>
                </div>
                <div style="text-align:center"><input type="number" class="input-box" value="${val}" placeholder="0" oninput="update(${idx}, this.value)" inputmode="numeric"></div>
                <div class="subtotal-cell" id="row-t-${idx}">${data.s}${(parseFloat(val||0) * item.v).toLocaleString()}</div>`;
            cont.appendChild(row);
        });
        updateTotal();
    }

    function update(idx, val) {
        counts[`${curKey}_${idx}`] = val;
        saveSecureData();
        const item = currencies[curKey].d[idx];
        document.getElementById(`row-t-${idx}`).textContent = format((parseFloat(val)||0) * item.v);
        updateTotal();
    }

    function updateTotal() {
        let total = 0;
        currencies[curKey].d.forEach((item, i) => total += (parseFloat(counts[`${curKey}_${i}`]) || 0) * item.v);
        document.getElementById('grandTotal').textContent = format(total);
        // Using Internationalization API for words for perfect localization across 11 languages
        document.getElementById('totalWords').textContent = numberToWords(total);
    }

    function format(n) {
        const s = currencies[curKey].s;
        const d = ["JPY", "SEK", "KRW"].includes(curKey) ? 0 : 2;
        return s + n.toLocaleString(undefined, {minimumFractionDigits: d, maximumFractionDigits: d});
    }

    function toggleFS() { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); }
    function resetAll() { if(confirm("Clear current count?")) { Object.keys(counts).forEach(k => { if(k.startsWith(curKey)) delete counts[k]; }); saveSecureData(); render(); } }

    window.onload = boot;
</script>
</body>
</html>
