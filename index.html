<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cash Tally Pro</title>
    <style>
        :root { 
            --p: #0f172a; --a: #3b82f6; --bg: #f8fafc; --s: #10b981; --card: #ffffff; --text: #1e293b; --border: #e2e8f0;
        }
        body.dark-mode {
            --p: #1e293b; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; --border: #334155;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: -apple-system, system-ui, sans-serif; 
            background: var(--bg); margin: 0; padding-bottom: 120px;
            color: var(--text); overflow-x: hidden; transition: background 0.3s;
        }

        header { 
            background: var(--p); color: white; padding: 15px 20px; 
            position: sticky; top: 0; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
        }

        .header-controls { display: flex; align-items: center; gap: 10px; }

        .currency-selector { 
            padding: 8px; border-radius: 8px; background: white; 
            font-weight: bold; font-size: 0.9rem; color: #0f172a; border: none; width: 140px;
        }

        .icon-btn {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3);
            color: white; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 1rem;
        }

        .menu-dropdown {
            position: absolute; top: 60px; right: 20px; background: var(--card);
            border: 1px solid var(--border); border-radius: 12px; display: none;
            flex-direction: column; width: 180px; box-shadow: 0 10px 15px rgba(0,0,0,0.2); z-index: 2005;
        }
        .menu-item {
            padding: 15px; border-bottom: 1px solid var(--border); color: var(--text);
            text-decoration: none; font-size: 0.9rem; cursor: pointer; display: flex; align-items: center; gap: 10px;
        }
        .menu-item:last-child { border-bottom: none; }

        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 3000;
        }
        .modal-content {
            background: var(--card); color: var(--text); padding: 25px; border-radius: 15px;
            width: 90%; max-width: 400px;
        }

        .container { max-width: 500px; margin: 0 auto; padding: 10px; }
        .section-divider { padding: 15px 5px 5px; font-size: 0.7rem; font-weight: 800; color: #a1a1aa; text-transform: uppercase; border-bottom: 1px solid var(--border); margin-bottom: 10px;}
        
        .cash-row { 
            background: var(--card); border-radius: 12px; padding: 12px 15px; 
            margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between; 
            border: 1px solid var(--border);
        }

        .denom-label { display: flex; align-items: center; gap: 12px; }

        .denom-visual { 
            width: 55px; height: 35px; background: #f1f5f9; border: 2px solid #cbd5e1; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 0.7rem; font-weight: 800; border-radius: 6px; color: #0f172a;
        }
        .visual-coin { border-radius: 50%; width: 40px; height: 40px; }

        .input-box { 
            width: 90px; padding: 12px; border: 2px solid var(--border); 
            border-radius: 10px; font-size: 1.2rem; text-align: center; font-weight: 800;
            background: var(--card); color: var(--text);
        }

        .row-total { display: block; font-size: 0.75rem; color: #64748b; text-align: right; margin-top: 4px; font-family: monospace; }

        .footer-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: var(--card); border-top: 1px solid var(--border);
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; z-index: 2000;
        }

        .fs-btn {
            position: fixed; bottom: 85px; right: 20px; background: var(--p); color: white;
            width: 45px; height: 45px; border-radius: 50%; border: none;
            display: flex; align-items: center; justify-content: center; z-index: 2001; font-size: 1.2rem;
        }
    </style>
</head>
<body>

<header>
    <select id="currencySelect" class="currency-selector" onchange="changeCurrency()"></select>
    <div class="header-controls">
        <button class="icon-btn" onclick="toggleRotation()">ðŸ”„</button>
        <button class="icon-btn" onclick="toggleMenu()">â‹®</button>
    </div>
</header>

<div id="menu" class="menu-dropdown">
    <div class="menu-item" onclick="toggleDarkMode()">ðŸŒ™ Dark Mode</div>
    <div class="menu-item" onclick="showTips()">ðŸ’¡ Pro-Tips</div>
</div>

<div id="tipsModal" class="modal" onclick="closeTips()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h3 style="margin-top:0">ðŸ’¡ Phone Pro-Tips</h3>
        <p>â€¢ <b>Add to Home Screen:</b> Open in Chrome, tap the 3 dots, and select "Add to Home screen" for a full-app feel.</p>
        <p>â€¢ <b>Back Gesture:</b> Swiping back exits Fullscreen mode before closing the page.</p>
        <p>â€¢ <b>Landscape:</b> Rotate your phone for better visibility with large amounts.</p>
        <button class="icon-btn" style="background:var(--a); width:100%; height: 50px; margin-top: 10px" onclick="closeTips()">Close</button>
    </div>
</div>

<div id="appContainer" class="container"></div>
<button class="fs-btn" onclick="toggleFS()">â›¶</button>

<div class="footer-bar">
    <div>
        <div style="font-size: 0.6rem; font-weight: 900; color: #64748b;" id="totalLabel">GRAND TOTAL</div>
        <div id="grandTotal" style="font-size: 1.8rem; font-weight: 900; color: var(--s);">0.00</div>
    </div>
    <button style="background:#fee2e2; border:none; color:#dc2626; padding:12px 20px; border-radius:10px; font-weight:bold;" onclick="resetAll()">Reset</button>
</div>

<script>
    const currencies = {
        "AUD": { n: "Australia (Dollar)", s: "$", d: [
            {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'},
            {l: "2", v: 2, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}, {l: "50c", v: 0.5, t: 'Coin'}, {l: "20c", v: 0.2, t: 'Coin'}, {l: "10c", v: 0.1, t: 'Coin'}, {l: "5c", v: 0.05, t: 'Coin'}
        ]},
        "CAD": { n: "Canada (Dollar)", s: "$", d: [
            {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'},
            {l: "$2", v: 2, t: 'Coin (Toonie)'}, {l: "$1", v: 1, t: 'Coin (Loonie)'}, {l: "50Â¢", v: 0.5, t: 'Coin'}, {l: "25Â¢", v: 0.25, t: 'Coin'}, {l: "10Â¢", v: 0.1, t: 'Coin'}, {l: "5Â¢", v: 0.05, t: 'Coin'}
        ]},
        "USD": { n: "USA (Dollar)", s: "$", d: [
            {l: "100", v: 100, t: 'Federal Reserve Note'}, {l: "50", v: 50, t: 'Federal Reserve Note'}, {l: "20", v: 20, t: 'Federal Reserve Note'}, {l: "10", v: 10, t: 'Federal Reserve Note'}, {l: "5", v: 5, t: 'Federal Reserve Note'}, {l: "2", v: 2, t: 'Federal Reserve Note'}, {l: "1", v: 1, t: 'Federal Reserve Note'},
            {l: "$1", v: 1, t: 'Coin'}, {l: "50Â¢", v: 0.5, t: 'Coin'}, {l: "25Â¢", v: 0.25, t: 'Coin'}, {l: "10Â¢", v: 0.1, t: 'Coin'}, {l: "5Â¢", v: 0.05, t: 'Coin'}, {l: "1Â¢", v: 0.01, t: 'Coin'}
        ]},
        "GBP": { n: "UK (Pound)", s: "Â£", d: [
            {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'},
            {l: "2", v: 2, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}, {l: "50p", v: 0.5, t: 'Coin'}, {l: "20p", v: 0.2, t: 'Coin'}, {l: "10p", v: 0.1, t: 'Coin'}, {l: "5p", v: 0.05, t: 'Coin'}, {l: "2p", v: 0.02, t: 'Coin'}, {l: "1p", v: 0.01, t: 'Coin'}
        ]},
        "EUR": { n: "Eurozone (Euro)", s: "â‚¬", d: [
            {l: "500", v: 500, t: 'Banknote'}, {l: "200", v: 200, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'},
            {l: "2", v: 2, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}, {l: "50c", v: 0.5, t: 'Coin'}, {l: "20c", v: 0.2, t: 'Coin'}, {l: "10c", v: 0.1, t: 'Coin'}, {l: "5c", v: 0.05, t: 'Coin'}, {l: "2c", v: 0.02, t: 'Coin'}, {l: "1c", v: 0.01, t: 'Coin'}
        ]},
        "INR": { n: "India (Rupee)", s: "â‚¹", d: [
            {l: "2000", v: 2000, t: 'Banknote'}, {l: "500", v: 500, t: 'Banknote'}, {l: "200", v: 200, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'},
            {l: "20", v: 20, t: 'Coin'}, {l: "10", v: 10, t: 'Coin'}, {l: "5", v: 5, t: 'Coin'}, {l: "2", v: 2, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}
        ]},
        "MXN": { n: "Mexico (Peso)", s: "$", d: [
            {l: "1000", v: 1000, t: 'Billete'}, {l: "500", v: 500, t: 'Billete'}, {l: "200", v: 200, t: 'Billete'}, {l: "100", v: 100, t: 'Billete'}, {l: "50", v: 50, t: 'Billete'}, {l: "20", v: 20, t: 'Billete'},
            {l: "20", v: 20, t: 'Moneda'}, {l: "10", v: 10, t: 'Moneda'}, {l: "5", v: 5, t: 'Moneda'}, {l: "2", v: 2, t: 'Moneda'}, {l: "1", v: 1, t: 'Moneda'}, {l: "50Â¢", v: 0.5, t: 'Moneda'}, {l: "20Â¢", v: 0.2, t: 'Moneda'}
        ]},
        "RUB": { n: "Russia (Ruble)", s: "â‚½", d: [
            {l: "5000", v: 5000, t: 'Banknote'}, {l: "2000", v: 2000, t: 'Banknote'}, {l: "1000", v: 1000, t: 'Banknote'}, {l: "500", v: 500, t: 'Banknote'}, {l: "200", v: 200, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote (Rare)'},
            {l: "10", v: 10, t: 'Coin'}, {l: "5", v: 5, t: 'Coin'}, {l: "2", v: 2, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}
        ]},
        "AED": { n: "UAE (Dirham)", s: "AED ", d: [
            {l: "1000", v: 1000, t: 'Banknote'}, {l: "500", v: 500, t: 'Banknote'}, {l: "200", v: 200, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'},
            {l: "1", v: 1, t: 'Coin'}, {l: "50f", v: 0.5, t: 'Coin (Fils)'}, {l: "25f", v: 0.25, t: 'Coin (Fils)'}
        ]},
        "SGD": { n: "Singapore (Dollar)", s: "S$", d: [
            {l: "10000", v: 10000, t: 'Banknote (Limited)'}, {l: "1000", v: 1000, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'}, {l: "2", v: 2, t: 'Banknote'},
            {l: "$1", v: 1, t: 'Coin'}, {l: "50Â¢", v: 0.5, t: 'Coin'}, {l: "20Â¢", v: 0.2, t: 'Coin'}, {l: "10Â¢", v: 0.1, t: 'Coin'}, {l: "5Â¢", v: 0.05, t: 'Coin'}
        ]},
        "MYR": { n: "Malaysia (Ringgit)", s: "RM", d: [
            {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'}, {l: "1", v: 1, t: 'Banknote'},
            {l: "50s", v: 0.5, t: 'Coin (Sen)'}, {l: "20s", v: 0.2, t: 'Coin (Sen)'}, {l: "10s", v: 0.1, t: 'Coin (Sen)'}, {l: "5s", v: 0.05, t: 'Coin (Sen)'}
        ]},
        "PHP": { n: "Philippines (Peso)", s: "â‚±", d: [
            {l: "1000", v: 1000, t: 'Banknote'}, {l: "500", v: 500, t: 'Banknote'}, {l: "200", v: 200, t: 'Banknote'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'},
            {l: "20", v: 20, t: 'Coin'}, {l: "10", v: 10, t: 'Coin'}, {l: "5", v: 5, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}, {l: "25Â¢", v: 0.25, t: 'Coin (Sentimo)'}, {l: "5Â¢", v: 0.05, t: 'Coin (Sentimo)'}, {l: "1Â¢", v: 0.01, t: 'Coin (Sentimo)'}
        ]},
        "HKD": { n: "Hong Kong (Dollar)", s: "HK$", d: [
            {l: "1000", v: 1000, t: 'Banknote'}, {l: "500", v: 500, t: 'Banknote'}, {l: "150", v: 150, t: 'Banknote (Commem.)'}, {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'},
            {l: "$10", v: 10, t: 'Coin'}, {l: "$5", v: 5, t: 'Coin'}, {l: "$2", v: 2, t: 'Coin'}, {l: "$1", v: 1, t: 'Coin'}, {l: "50Â¢", v: 0.5, t: 'Coin'}, {l: "20Â¢", v: 0.2, t: 'Coin'}, {l: "10Â¢", v: 0.1, t: 'Coin'}
        ]},
        "JPY": { n: "Japan (Yen)", s: "Â¥", d: [
            {l: "10000", v: 10000, t: 'Banknote'}, {l: "5000", v: 5000, t: 'Banknote'}, {l: "2000", v: 2000, t: 'Banknote (Rare)'}, {l: "1000", v: 1000, t: 'Banknote'},
            {l: "500", v: 500, t: 'Coin'}, {l: "100", v: 100, t: 'Coin'}, {l: "50", v: 50, t: 'Coin'}, {l: "10", v: 10, t: 'Coin'}, {l: "5", v: 5, t: 'Coin'}, {l: "1", v: 1, t: 'Coin'}
        ]},
        "CNY": { n: "China (Yuan)", s: "Â¥", d: [
            {l: "100", v: 100, t: 'Banknote'}, {l: "50", v: 50, t: 'Banknote'}, {l: "20", v: 20, t: 'Banknote'}, {l: "10", v: 10, t: 'Banknote'}, {l: "5", v: 5, t: 'Banknote'}, {l: "1", v: 1, t: 'Banknote'}, {l: "5è§’", v: 0.5, t: 'Banknote (Jiao)'}, {l: "1è§’", v: 0.1, t: 'Banknote (Jiao)'},
            {l: "1å…ƒ", v: 1, t: 'Coin (Yuan)'}, {l: "5è§’", v: 0.5, t: 'Coin (Jiao)'}, {l: "1è§’", v: 0.1, t: 'Coin (Jiao)'}
        ]},
        "SEK": { n: "Sweden (Krona)", s: "kr ", d: [
            {l: "1000", v: 1000, t: 'Sedel'}, {l: "500", v: 500, t: 'Sedel'}, {l: "200", v: 200, t: 'Sedel'}, {l: "100", v: 100, t: 'Sedel'}, {l: "50", v: 50, t: 'Sedel'}, {l: "20", v: 20, t: 'Sedel'},
            {l: "10", v: 10, t: 'Mynt'}, {l: "5", v: 5, t: 'Mynt'}, {l: "2", v: 2, t: 'Mynt'}, {l: "1", v: 1, t: 'Mynt'}
        ]}
    };

    let counts = {}, curKey = "AUD";

    function boot() {
        const sel = document.getElementById('currencySelect');
        for (let k in currencies) {
            const o = document.createElement('option');
            o.value = k; o.textContent = currencies[k].n;
            sel.appendChild(o);
        }
        changeCurrency();
        window.addEventListener('popstate', () => {
            if (document.fullscreenElement) document.exitFullscreen();
        });
    }

    function toggleMenu() {
        const menu = document.getElementById('menu');
        menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        toggleMenu();
    }

    function showTips() {
        document.getElementById('tipsModal').style.display = 'flex';
        toggleMenu();
    }

    function closeTips() {
        document.getElementById('tipsModal').style.display = 'none';
    }

    function changeCurrency() {
        curKey = document.getElementById('currencySelect').value;
        counts = {};
        render();
    }

    function render() {
        const cont = document.getElementById('appContainer');
        cont.innerHTML = '';
        const data = currencies[curKey];
        let lastT = '';
        data.d.forEach((item, idx) => {
            if (item.t !== lastT) {
                const head = document.createElement('div');
                head.className = 'section-divider';
                head.textContent = item.t;
                cont.appendChild(head);
                lastT = item.t;
            }
            const row = document.createElement('div');
            row.className = 'cash-row';
            row.innerHTML = `
                <div class="denom-label">
                    <div class="denom-visual ${item.t.toLowerCase().includes('coin') || item.t.toLowerCase().includes('mynt') || item.t.toLowerCase().includes('moneda') ? 'visual-coin' : ''}">${item.l}</div>
                    <span style="font-weight:700">${item.l}</span>
                </div>
                <div>
                    <input type="number" class="input-box" placeholder="0" oninput="update(${idx}, this.value)" inputmode="numeric">
                    <span class="row-total" id="row-t-${idx}">${data.s}0.00</span>
                </div>`;
            cont.appendChild(row);
        });
        updateTotal();
    }

    function update(idx, val) {
        counts[idx] = parseFloat(val) || 0;
        const item = currencies[curKey].d[idx];
        document.getElementById(`row-t-${idx}`).textContent = format(counts[idx] * item.v);
        updateTotal();
    }

    function updateTotal() {
        let total = 0;
        currencies[curKey].d.forEach((item, i) => total += (counts[i] || 0) * item.v);
        document.getElementById('grandTotal').textContent = format(total);
    }

    function format(n) {
        const s = currencies[curKey].s;
        const d = (curKey === "JPY" || curKey === "SEK") ? 0 : 2;
        return s + n.toLocaleString(undefined, {minimumFractionDigits: d, maximumFractionDigits: d});
    }

    function toggleFS() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
            history.pushState({fs: true}, "");
        } else {
            document.exitFullscreen();
        }
    }

    function toggleRotation() {
        if (screen.orientation) {
            const type = screen.orientation.type.includes('portrait') ? 'landscape' : 'portrait';
            screen.orientation.lock(type).catch(() => alert("Enable Auto-Rotate in system settings."));
        }
    }

    function resetAll() { if(confirm("Reset all counts?")) { counts = {}; render(); } }

    window.onload = boot;
</script>
</body>
</html>
